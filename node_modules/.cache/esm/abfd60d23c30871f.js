let uuidv4,Context;_3c3‍.x([["default",()=>Watcher]]);_3c3‍.w("uuid",[["v4",["uuidv4"],function(v){uuidv4=v}]]);_3c3‍.w("./Context",[["default",["Context"],function(v){Context=v}]]);


               class Watcher {
    constructor(ctx, ...effects) {
        this._id = uuidv4();
        this._effects = new Set(effects);

        if(ctx) {
            this.watch(ctx);
        }

        return this;
    }

    /**
     * Add an effect function to the <Context>
     */
    add(...effects) {
        this._effects = new Set([
            ...this._effects,
            ...effects,
        ]);

        return this._effects;
    }
    /**
     * Remove an effect function to the <Context>
     */
    remove(...effects) {
        for(let effect of effects) {
            this._effects.delete(effect);
        }

        return this._effects;
    }

    watch(ctx) {
        if(ctx instanceof Context) {
            ctx.on("update", (...args) => this.run.call(this, ctx, ...args));
        }

        return this;
    }

    
    run(ctx, ...args) {
        return new Promise((resolve, reject) => {
            for(let effect of this._effects) {
                if(typeof effect === "function") {
                    effect(...args);
                }
            }

            resolve(ctx, ...args);
        });
    }
};