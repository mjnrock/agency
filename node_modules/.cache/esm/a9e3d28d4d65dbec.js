let Context,Validator,Registry,Observer;_4d6‍.w("../Context",[["default",["Context"],function(v){Context=v}]]);_4d6‍.w("../Validator",[["default",["Validator"],function(v){Validator=v}]]);_4d6‍.w("../Registry",[["default",["Registry"],function(v){Registry=v}]]);_4d6‍.w("../Observer",[["default",["Observer"],function(v){Observer=v}]]);




const reg = new Registry();

reg.alias(new Validator(
    (state) => Date.now() > state.lastTimestamp - 50,
), "Incrementor");

const ctx = new Context({
    lastTimestamp: Date.now(),
    count: 0,
}, [
    (state, validatorId) => {
        if(validatorId === reg.getId("Incrementor")) {
            return ({
                lastTimestamp: Date.now(),
                count: state.count + 1,
            })
        }
    },
]);
const obs = new Observer(ctx, _4d6‍.g.console.log);

// //! Unattached execution (<Context.state> is not natively passed to unattached executions)
ctx.attempt(reg.get("Incrementor"), ctx.state);
ctx.attempt(reg.get("Incrementor"), ctx.state);
console.warn(`[Test]: Expected - ${ 2 } | Actual - ${ ctx.state.count }`);

// //! Attached execution
// ctx.attach(reg.get("Incrementor"));
// ctx.run();
// ctx.run();
// console.info(`[Test]: Expected - ${ 4 } | Actual - ${ ctx.state.count }`);